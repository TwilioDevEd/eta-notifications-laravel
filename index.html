<!DOCTYPE html><html><head><title>ETA Notifications</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="ETA Notifications"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">ETA Notifications</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>In this tutorial, we will learn how to implement ETA Notifications using PHP - Laravel and Twilio</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Setting Up The Application" class="chapter"><div data-title="What Are We Building?" data-file="app/Http/routes.php" class="step"><h2 id="eta-notifications">Eta Notifications</h2>
<h2 id="laundry-on-demand">Laundry On-Demand</h2>
<p><img src="http://howtodocs.s3.amazonaws.com/eta-notifications.png" alt="ETA Notifications"></p>
<p>There are a wide range of businesses that deliver goods or services to their
customers on-demand. Companies like Uber, TaskRabbit, and Instacart have built
an entire industry around the fact that we, the customer, like to order things
instantly, and be notified of their progress towards us.</p>
<p>In this tutorial, we&#39;ll build a notification system for Laundr.io ,an on-demand
laundry service. In this app we will allow the delivery person to trigger notification events when:</p>
<ol>
<li>Delivery person picks up laundry to be delivered</li>
<li>Delivery person is arriving to the customer&#39;s house.</li>
</ol>
<p>In a production app we would probably trigger the second notification when
the Delivery person was physically near the customer, using GPS. In this
case we&#39;ll just use a button.</p>
<p>Let&#39;s get started!</p>
</div><div data-title="Trigger the Notifications" data-file="app/Http/Controllers/OrderController.php" data-highlight="21-53" class="step"><h2 id="trigger-the-notifications">Trigger the Notifications</h2>
<p>This screen shows two buttons that allow the laundry delivery
person to trigger notifications. There are two cases we&#39;d like to handle:</p>
<ol>
<li>Send a notification when the laundry delivery person picked up the
clothes, so the client will receive a SMS with the ETA of their
clothes.</li>
<li>Send a notification when the clothes have arrived to their destination.</li>
</ol>
<p>Now, on the server we&#39;re going to use the Twilio API Client to actually
send out the notifications.</p>
</div><div data-title="Setting Up the Twilio REST Client" data-file="app/Providers/TwilioRestClientProvider.php" data-highlight="15-20" class="step"><h2 id="setting-up-the-twilio-rest-client">Setting up the Twilio REST Client</h2>
<p>Here we create an authenticated Twilio REST API client that we can use
anytime we need to send a text message.We initialize it with our
<a href="//www.twilio.com/user/account/messaging/dashboard">Twilio Account Credentials</a>
stored as environment variables.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//www.twilio.com/docs/quickstart/php/sms/sending-via-rest">Twilio Rest Client - Send SMS</a></li>
<li><a href="//laravel.com/docs/master/providers">Laravel Service Providers</a></li>
</ul>
</div><div data-title="Handling the Notification Trigger" data-file="app/Http/Controllers/OrderController.php" data-highlight="61-73" class="step"><h2 id="handling-the-notification-trigger">Handling the Notification Trigger</h2>
<p>In <code>OrderController</code> we extract the phone number stored in each order,
and then simply send an SMS message with the specified body.</p>
<p>Next let&#39;s look closer at how we send the SMS.</p>
</div><div data-title="Handling the Twilio Callback" data-file="app/Http/Controllers/OrderController.php" data-highlight="55-59" class="step"><h2 id="handling-the-twilio-callback">Handling the Twilio Callback</h2>
<p>Twilio will make a post request each time your message status changes to one of the following: queued, failed, sent, delivered, or undelivered.</p>
<p>The order&#39;s notifications status will change accordingly.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//www.twilio.com/docs/api/rest/sending-messages#status-callback-parameter-request-parameters">Message Status</a></li>
</ul>
</div><div class="step"><h2 id="where-to-next-">Where to next?</h2>
<p>That&#39;s it! We&#39;ve just implemented an application to instantly route leads
to sales people using text messages.</p>
<p>If you are a PHP developer working with Twilio,  you might want
to check out these other tutorials:</p>
<p><a href="//www.twilio.com/docs/howto/walkthrough/click-to-call/php/laravel"><strong>Click-To-Call</strong></a></p>
<p>Put a button on your web page that connects visitors to live support or sales people via telephone.</p>
<p><a href="https://www.twilio.com/docs/howto/walkthrough/automated-survey/php/laravel"><strong>Automated Survey</strong></a></p>
<p>Instantly collect structured data from your users with a survey conducted
over a voice call or SMS text messages.</p>
<h2 id="did-this-help-">Did this help?</h2>
<p>Thanks for checking out this tutorial! If you have any feedback to share
with us, we&#39;d love to hear it. Tweet
<a href="http://twitter.com/twilio">@twilio</a> to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="app/Http/routes.php" data-mode="php">PD9waHAKCi8qCnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQp8IFJvdXRlcyBGaWxlCnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQp8CnwgSGVyZSBpcyB3aGVyZSB5b3Ugd2lsbCByZWdpc3RlciBhbGwgb2YgdGhlIHJvdXRlcyBpbiBhbiBhcHBsaWNhdGlvbi4KfCBJdCdzIGEgYnJlZXplLiBTaW1wbHkgdGVsbCBMYXJhdmVsIHRoZSBVUklzIGl0IHNob3VsZCByZXNwb25kIHRvCnwgYW5kIGdpdmUgaXQgdGhlIGNvbnRyb2xsZXIgdG8gY2FsbCB3aGVuIHRoYXQgVVJJIGlzIHJlcXVlc3RlZC4KfAoqLwoKUm91dGU6Omdyb3VwKFsnbWlkZGxld2FyZScgPT4gWyd3ZWInXV0sIGZ1bmN0aW9uICgpIHsKICAgIFJvdXRlOjpnZXQoJy8nLAogICAgICAgIFsnYXMnID0+ICdvcmRlci5pbmRleCcsCiAgICAgICAgICd1c2VzJyA9PiAnT3JkZXJDb250cm9sbGVyQGluZGV4J10KICAgICk7CgogICAgUm91dGU6OmdldCgnL29yZGVyL3tpZH0nLAogICAgICAgIFsnYXMnID0+ICdvcmRlci5zaG93JywKICAgICAgICAgJ3VzZXMnID0+ICdPcmRlckNvbnRyb2xsZXJAc2hvdyddCiAgICApOwoKICAgIFJvdXRlOjpwb3N0KCcvb3JkZXIve2lkfS9waWNrdXAnLAogICAgICAgIFsnYXMnID0+ICdvcmRlci5waWNrdXAnLAogICAgICAgICAndXNlcycgPT4gJ09yZGVyQ29udHJvbGxlckBwaWNrdXAnXQogICAgKTsKCiAgICBSb3V0ZTo6cG9zdCgnL29yZGVyL3tpZH0vZGVsaXZlcicsCiAgICAgICAgWydhcycgPT4gJ29yZGVyLmRlbGl2ZXInLAogICAgICAgICAndXNlcycgPT4gJ09yZGVyQ29udHJvbGxlckBkZWxpdmVyJ10KICAgICk7CiAgICBSb3V0ZTo6cG9zdCgnL29yZGVyL3tpZH0vbm90aWZpY2F0aW9uL3N0YXR1cy91cGRhdGUnLAogICAgICAgIFsnYXMnID0+ICdvcmRlci5ub3RpZmljYXRpb24uc3RhdHVzJywKICAgICAgICAgJ3VzZXMnID0+ICdPcmRlckNvbnRyb2xsZXJAbm90aWZpY2F0aW9uU3RhdHVzJ10KICAgICk7Cn0pOwo=</textarea>
<textarea class="saurus-file" data-file="app/Http/Controllers/OrderController.php" data-mode="php">PD9waHAKbmFtZXNwYWNlIEFwcFxIdHRwXENvbnRyb2xsZXJzOwp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7CnVzZSBBcHBcSHR0cFxSZXF1ZXN0czsKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBBcHBcT3JkZXI7CnVzZSBTZXJ2aWNlc19Ud2lsaW8gYXMgVHdpbGlvUmVzdENsaWVudDsKdXNlIExvZzsKCmNsYXNzIE9yZGVyQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICByZXR1cm4gdmlldygnaW5kZXgnLCBbJ29yZGVycycgPT4gT3JkZXI6OmFsbCgpXSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNob3coJGlkKSB7CiAgICAgICAgcmV0dXJuIHZpZXcoJ3Nob3cnLCBbJ29yZGVyJyA9PiBPcmRlcjo6ZmluZCgkaWQpXSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHBpY2t1cChUd2lsaW9SZXN0Q2xpZW50ICRjbGllbnQsIFJlcXVlc3QgJHJlcXVlc3QsICRpZCkgewogICAgICAgICRvcmRlciA9IE9yZGVyOjpmaW5kKCRpZCk7CiAgICAgICAgJG9yZGVyLT5zdGF0dXMgPSAnU2hpcHBlZCc7CiAgICAgICAgJG9yZGVyLT5ub3RpZmljYXRpb25fc3RhdHVzID0gJ3F1ZXVlZCc7CiAgICAgICAgJG9yZGVyLT5zYXZlKCk7CgogICAgICAgICRjYWxsYmFja1VybCA9IHN0cl9yZXBsYWNlKCcvcGlja3VwJywgJycsICRyZXF1ZXN0LT51cmwoKSkgLiAnL25vdGlmaWNhdGlvbi9zdGF0dXMvdXBkYXRlJzsKICAgICAgICAkdGhpcy0+c2VuZE1lc3NhZ2UoCiAgICAgICAgICAgICRjbGllbnQsCiAgICAgICAgICAgICRvcmRlci0+cGhvbmVfbnVtYmVyLAogICAgICAgICAgICAnWW91ciBsYXVuZHJ5IGlzIGRvbmUgYW5kIG9uIGl0cyB3YXkgdG8geW91IScsCiAgICAgICAgICAgICRjYWxsYmFja1VybAogICAgICAgICk7CgogICAgICAgIHJldHVybiByZWRpcmVjdCgpLT5yb3V0ZSgnb3JkZXIuc2hvdycsIFsnaWQnID0+ICRvcmRlci0+aWRdKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVsaXZlcihUd2lsaW9SZXN0Q2xpZW50ICRjbGllbnQsIFJlcXVlc3QgJHJlcXVlc3QsICRpZCkgewogICAgICAgICRvcmRlciA9IE9yZGVyOjpmaW5kKCRpZCk7CiAgICAgICAgJG9yZGVyLT5zdGF0dXMgPSAnRGVsaXZlcmVkJzsKICAgICAgICAkb3JkZXItPm5vdGlmaWNhdGlvbl9zdGF0dXMgPSAncXVldWVkJzsKICAgICAgICAkb3JkZXItPnNhdmUoKTsKCiAgICAgICAgJGNhbGxiYWNrVXJsID0gc3RyX3JlcGxhY2UoJy9kZWxpdmVyJywgJycsICRyZXF1ZXN0LT51cmwoKSkgLiAnL25vdGlmaWNhdGlvbi9zdGF0dXMvdXBkYXRlJzsKICAgICAgICAkdGhpcy0+c2VuZE1lc3NhZ2UoCiAgICAgICAgICAgICRjbGllbnQsCiAgICAgICAgICAgICRvcmRlci0+cGhvbmVfbnVtYmVyLAogICAgICAgICAgICAnWW91ciBsYXVuZHJ5IGlzIGFycml2aW5nIG5vdy4nLAogICAgICAgICAgICAkY2FsbGJhY2tVcmwKICAgICAgICApOwoKICAgICAgICByZXR1cm4gcmVkaXJlY3QoKS0+cm91dGUoJ29yZGVyLmluZGV4Jyk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIG5vdGlmaWNhdGlvblN0YXR1cyhSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpIHsKICAgICAgICAkb3JkZXIgPSBPcmRlcjo6ZmluZCgkaWQpOwogICAgICAgICRvcmRlci0+bm90aWZpY2F0aW9uX3N0YXR1cyA9ICRyZXF1ZXN0LT5pbnB1dCgnTWVzc2FnZVN0YXR1cycpOwogICAgICAgICRvcmRlci0+c2F2ZSgpOwogICAgfQoKICAgIHByaXZhdGUgZnVuY3Rpb24gc2VuZE1lc3NhZ2UoJGNsaWVudCwgJHRvLCAkbWVzc2FnZUJvZHksICRjYWxsYmFja1VybCkgewogICAgICAgICR0d2lsaW9OdW1iZXIgPSBjb25maWcoJ3NlcnZpY2VzLnR3aWxpbycpWydudW1iZXInXTsKICAgICAgICB0cnkgewogICAgICAgICAgICAkY2xpZW50LT5hY2NvdW50LT5tZXNzYWdlcy0+Y3JlYXRlKFsKICAgICAgICAgICAgICAgICdGcm9tJyA9PiAkdHdpbGlvTnVtYmVyLCAvLyBGcm9tIGEgVHdpbGlvIG51bWJlciBpbiB5b3VyIGFjY291bnQKICAgICAgICAgICAgICAgICdUbycgPT4gJHRvLCAvLyBUZXh0IGFueSBudW1iZXIKICAgICAgICAgICAgICAgICdCb2R5JyA9PiAkbWVzc2FnZUJvZHksCiAgICAgICAgICAgICAgICAnU3RhdHVzQ2FsbGJhY2snID0+ICRjYWxsYmFja1VybAogICAgICAgICAgICBdKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsKICAgICAgICAgICAgTG9nOjplcnJvcigkZS0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9Cn0K</textarea>
<textarea class="saurus-file" data-file="app/Providers/TwilioRestClientProvider.php" data-mode="php">PD9waHAKbmFtZXNwYWNlIEFwcFxQcm92aWRlcnM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcU2VydmljZVByb3ZpZGVyOwp1c2UgU2VydmljZXNfVHdpbGlvOwoKY2xhc3MgVHdpbGlvUmVzdENsaWVudFByb3ZpZGVyIGV4dGVuZHMgU2VydmljZVByb3ZpZGVyCnsKICAgIC8qKgogICAgICogUmVnaXN0ZXIgdGhlIGFwcGxpY2F0aW9uIHNlcnZpY2VzLgogICAgICoKICAgICAqIEByZXR1cm4gdm9pZAogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gcmVnaXN0ZXIoKQogICAgewogICAgICAgICR0aGlzLT5hcHAtPmJpbmQoCiAgICAgICAgICAgICdTZXJ2aWNlc19Ud2lsaW8nLCBmdW5jdGlvbiAoJGFwcCkgewogICAgICAgICAgICAgICAgJGFjY291bnRTaWQgPSBjb25maWcoJ3NlcnZpY2VzLnR3aWxpbycpWydhY2NvdW50U2lkJ107CiAgICAgICAgICAgICAgICAkYXV0aFRva2VuID0gY29uZmlnKCdzZXJ2aWNlcy50d2lsaW8nKVsnYXV0aFRva2VuJ107CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNlcnZpY2VzX1R3aWxpbygkYWNjb3VudFNpZCwgJGF1dGhUb2tlbik7CiAgICAgICAgICAgIH0KICAgICAgICApOwogICAgfQp9Cg==</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/eta-notifications-laravel" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>